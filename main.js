!function(){"use strict";class e{constructor(e){let{popupSelector:t}=e;this._popupSelector=t,this.popupElement=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this)}open(){this.popupElement.classList.add("modal_opened"),this.popupElement.querySelector(".modal__overlay").classList.add("modal__overlay_active"),document.addEventListener("keydown",this._handleEscClose)}close(){this.popupElement.classList.remove("modal_opened"),this.popupElement.querySelector(".modal__overlay").classList.remove("modal__overlay_active"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this.popupElement.querySelector(".modal__close-button").addEventListener("click",(()=>{this.close()})),this.popupElement.addEventListener("click",(e=>{e.target.classList.contains("modal")&&this.close()}))}}function t(t,r){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Save";return r instanceof e?(r.popupElement,r.submitButton?Promise.resolve(t()).then((()=>{r.close()})).catch((e=>{throw console.error(`Error: ${e}`),e})).finally((()=>{r.renderLoading(!1,s)})):(console.error("Submit button not found in popup."),Promise.reject("Submit button not found"))):(console.error("The provided popupInstance is not an instance of Popup."),Promise.reject("Invalid popup instance"))}class r{constructor(e,t,r,s,i){this._title=e.name,this._image=e.link,this._id=e._id,this.isLiked=e.isLiked||!1,this._cardSelector=t,this._handleImageClick=r,this._handleDeleteClick=s,this._handleLikeClick=i,this._cardTemplate=document.querySelector(this._cardSelector),this._cardElement=this._getCardElement(),this._setEventListeners(),this._updateLikeState()}_setEventListeners(){this._cardElement.querySelector(".cards__like-button").addEventListener("click",(()=>{this._handleLikeClick(this)})),this._cardElement.querySelector(".cards__delete-button").addEventListener("click",(()=>{this._handleDeleteClick(this)})),this._cardElement.querySelector(".cards__image").addEventListener("click",(()=>{this._handleImageClick(this._title,this._image)}))}_getCardElement(){const e=this._cardTemplate.content.firstElementChild.cloneNode(!0);return e.querySelector(".cards__title").textContent=this._title,e.querySelector(".cards__image").src=this._image,e.querySelector(".cards__image").alt=this._title,e}getCardElement(){return this._cardElement}getId(){return this._id}removeCard(){this._cardElement?(this._cardElement.remove(),this._cardElement=null):console.error("Card element is null for card:",this)}_updateLikeState(){this._cardElement.querySelector(".cards__like-button").classList.toggle("cards__like-button_active",this.isLiked)}updateLikeState(e){this.isLiked=e,this._updateLikeState()}}function s(e,t,s,i){return new r(e,"#card-template",t,s,i).getCardElement()}class i{constructor(e,t){this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this.submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t,this._inputEls=Array.from(this._form.querySelectorAll(this._inputSelector)),this.submitButton=this._form.querySelector(this.submitButtonSelector),this._setEventListeners()}_setEventListeners(){this._form.addEventListener("submit",(e=>{e.preventDefault()}))}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_showInputError(e){const t=this._form.querySelector(`#${e.id}-error`);t.textContent=e.validationMessage,e.classList.add(this._inputErrorClass),t.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`#${e.id}-error`);t.textContent="",e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass)}_toggleButtonState(){this._hasInvalidInput()?this.disableButton():this.enableButton()}_hasInvalidInput(){return this._inputEls.some((e=>!e.validity.valid))}disableButton(){this.submitButton.setAttribute("disabled",!0),this.submitButton.classList.add(this._inactiveButtonClass)}enableButton(){this.submitButton.removeAttribute("disabled"),this.submitButton.classList.remove(this._inactiveButtonClass)}enableValidation(){this._inputEls.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}resetValidation(){this._toggleButtonState(),this._inputEls.forEach((e=>{this._hideInputError(e)}))}}class n extends e{constructor(e,t,r){super({popupSelector:e}),this._handleSubmit=t,this._form=this.popupElement.querySelector("form"),this.submitButton=this._form.querySelector("button[type='submit']"),this.submitButtonText=this.submitButton.textContent,this._formValidator=r,this._inputs=Array.from(this._form.querySelectorAll("input"))}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this.renderLoading(!0);const t=this._handleSubmit(this._getInputValues());if(!(t instanceof Promise))return console.error("The handleSubmit method did not return a promise."),void this.renderLoading(!1);t.then((()=>this.close())).catch((e=>console.error(`Error during form submission: ${e}`))).finally((()=>this.renderLoading(!1)))}))}resetForm(){this._form.reset()}open(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super.open(),this._populateForm(e),this._focusFirstInput(),this._formValidator.resetValidation()}_focusFirstInput(){const e=this._inputs[0];e&&e.focus()}_populateForm(e){Object.entries(e).forEach((e=>{let[t,r]=e;const s=this._form.querySelector(`input[name="${t}"]`);s&&(s.value=r)}))}_getInputValues(){const e={};return this._inputs.forEach((t=>{e[t.name]=t.value})),e}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this.submitButton.textContent=e?t:this.submitButtonText}}const o=document.querySelector("#profile-edit-button"),a=(document.querySelector("#profile-title"),document.querySelector("#profile-subtitle"),document.querySelector("#add-card-button")),l=document.querySelector(".profile__avatar-edit-button");let d=null,c={title:"",image:""};const u={};var h;h={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__save-button",inactiveButtonClass:"modal__save-button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},Array.from(document.querySelectorAll(h.formSelector)).forEach((e=>{const t=new i(h,e),r=e.getAttribute("name");u[r]=t,t.enableValidation()}));const m=new class extends e{constructor(e,t){let{popupSelector:r}=e;super({popupSelector:r}),this._onConfirmDeleteAction=t,this.submitButton=this.popupElement.querySelector(".modal__save-button"),this.submitButtonText=this.submitButton.textContent}setDeleteConfirmCallback(e){this._onConfirmDeleteAction=e}_confirmDelete=()=>"function"==typeof this._onConfirmDeleteAction?this._onConfirmDeleteAction():Promise.resolve();setEventListeners(){super.setEventListeners(),document.getElementById("confirm-delete-yes-button").addEventListener("click",(e=>{e.preventDefault(),this.renderLoading(!0);const t=this._confirmDelete();if(!(t instanceof Promise))return console.error("The _confirmDelete method did not return a promise."),void this.renderLoading(!1);t.then((()=>this.close())).catch((e=>console.error(`Error during deletion: ${e}`))).finally((()=>this.renderLoading(!1)))}))}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Deleting...";this.submitButton.textContent=e?t:this.submitButtonText}}({popupSelector:"#confirm-delete-modal"},(function(){return t((()=>d?E.deleteCard(d.getId()).then((()=>(d._cardElement?d.removeCard():console.warn("Card element is null"),d=null,Promise.resolve()))).catch((e=>(console.error("Error deleting card:",e),Promise.reject(e)))).finally((()=>{m.close()})):(console.error("No card to delete."),Promise.resolve())),m,"Yes","Deleting...")})),_=new n("#profile-image-modal",(function(e){return t((()=>E.updateProfileAvatar({avatar:e.image}).then((e=>{b.setUserAvatar({avatar:e.avatar})}))),_)}),u["profile-image-form"]),p=new n("#profile-edit-modal",(function(e){return t((()=>E.updateProfileInfo({name:e.title,description:e.subtitle}).then((e=>{b.setUserInfo(e)}))),p)}),u["profile-edit-form"]),f=new n("#add-card-modal",(function(e){return t((()=>E.addCard({name:e.title,link:e.image}).then((e=>{const t=s(e,L,S,C);g.addItem(t)}))),f)}),u["add-card-form"]),v=new class extends e{constructor(e){super({popupSelector:e}),this._imageElement=this.popupElement.querySelector(".modal__card-image"),this._captionElement=this.popupElement.querySelector(".modal__caption"),this._imageElement||console.error("Image element not found"),this._captionElement||console.error("Caption element not found")}open(e,t){e&&t?(this._imageElement.src=t,this._imageElement.alt=e,this._captionElement.textContent=e,super.open()):console.error("Image name or link is missing")}}("#card-image-modal"),E=new class{constructor(e){this._headers=e.headers,this._baseUrl=e.baseUrl}_handleResponse(e){return e.ok?e.json():Promise.reject(`Error ${e.status}`)}_request(e,t){return fetch(e,t).then(this._handleResponse)}getInitialCards(){return this._request(`${this._baseUrl}/cards`,{method:"GET",headers:this._headers})}addCard(e){let{name:t,link:r}=e;return t&&r?this._request(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:r})}):Promise.reject("Missing name or link")}deleteCard(e){return this._request(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers})}likeCard(e){return this._request(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers})}unlikeCard(e){return this._request(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers})}updateProfileInfo(e){let{name:t,description:r}=e;return this._request(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:r})})}updateProfileAvatar(e){let{avatar:t}=e;return this._request(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:t})})}getUserInfo(){return this._request(`${this._baseUrl}/users/me`,{method:"GET",headers:this._headers})}getAppData(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"298fcaaa-e173-4e81-9326-ea95e21a4625","Content-Type":"application/json"}}),b=new class{constructor(e){let{title:t,subtitle:r,avatar:s}=e;this._title=document.querySelector(t),this._subtitle=document.querySelector(r),this._avatar=document.querySelector(s)}getUserInfo(){return{title:this._title.textContent.trim(),subtitle:this._subtitle.textContent.trim(),avatar:this._avatar.src}}setUserInfo(e){let{name:t,about:r}=e;this._title.textContent=t,this._subtitle.textContent=r}setUserAvatar(e){let{avatar:t}=e;this._avatar.src=t}}({title:".profile__title",subtitle:".profile__subtitle",avatar:".profile__image"}),g=new class{constructor(e,t){let{items:r,renderer:s}=e;this._items=r,this._renderer=s,this._container=document.querySelector(t)}setItems(e){this._items=e||[],this.renderItems()}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}appendItem(e){this._container.append(e)}}({items:[],renderer:e=>{const t=s(e,L,S,C);g.addItem(t)}},"#card-list");function S(e){e._cardElement||console.error("Card element is null for card:",e),d=e,m.open()}function C(e){const t=!e.isLiked;e.updateLikeState(t),e.isLiked=t,(t?E.likeCard(e.getId()):E.unlikeCard(e.getId())).then((()=>{e.updateLikeState(t)})).catch((r=>{console.error("Error toggling like state:",r),e.updateLikeState(!t),e.isLiked=!t}))}function L(e,t){v.open(e,t)}(async()=>{try{const[e,t]=await Promise.all([E.getInitialCards(),E.getUserInfo()]);g.setItems(e),b.setUserInfo({name:t.name,about:t.about}),b.setUserAvatar({avatar:t.avatar})}catch(e){console.error("Initialization error:",e)}})(),p.setEventListeners(),f.setEventListeners(),v.setEventListeners(),_.setEventListeners(),m.setEventListeners(),o.addEventListener("click",(()=>{const e=b.getUserInfo();p.open({title:e.title,subtitle:e.subtitle}),u["profile-edit-form"].resetValidation()})),a.addEventListener("click",(()=>{f.open(c)})),l.addEventListener("click",(()=>{_.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QkFBaUIsU0FBUyxLQUMxQyxNQUFNOE4sRUFBWXBFLEVBQUswQyxjQUN2QnhDLEVBQWlCL0osS0FBSyxDQUNwQnNJLE1BQU8yRixFQUFVM0YsTUFDakI2QixTQUFVOEQsRUFBVTlELFdBRXRCM0IsRUFBZSxxQkFBcUJoQyxpQkFBaUIsSUFHdkQwQixFQUFjL0gsaUJBQWlCLFNBQVMsS0FDdENtSyxFQUFhdEssS0FBS3FJLEVBQWEsSUFHakNGLEVBQW1CaEksaUJBQWlCLFNBQVMsS0FDM0NxSixFQUFrQnhKLE1BQU0sRyIsInNvdXJjZXMiOlsid2VicGFjazovL2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vYXJvdW5kdGhldXMvLi9zcmMvdXRpbHMvaGFuZGxlU3VibWl0LmpzIiwid2VicGFjazovL2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9hcm91bmR0aGV1cy8uL3NyYy91dGlscy9jcmVhdGVDYXJkLmpzIiwid2VicGFjazovL2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vYXJvdW5kdGhldXMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vYXJvdW5kdGhldXMvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBEZWxldGVDYXJkLmpzIiwid2VicGFjazovL2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XHJcbiAgICB0aGlzLl9wb3B1cFNlbGVjdG9yID0gcG9wdXBTZWxlY3RvcjtcclxuICAgIHRoaXMucG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLnBvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgdGhpcy5wb3B1cEVsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX292ZXJsYXlcIilcclxuICAgICAgLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9fb3ZlcmxheV9hY3RpdmVcIik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMucG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICB0aGlzLnBvcHVwRWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fb3ZlcmxheVwiKVxyXG4gICAgICAuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX19vdmVybGF5X2FjdGl2ZVwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcclxuICAgIC8vIGhhbmRsZSBlc2MgYnV0dG9uXHJcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAvLyBoYW5kbGUgY2xvc2UgYnkgY2xvc2UgYnV0dG9uIGNsaWNrXHJcbiAgICBjb25zdCBjbG9zZUJ1dHRvbiA9IHRoaXMucG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiKTtcclxuICAgIGNsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIGhhbmRsZSBjbG9zZSBieSBvdmVybGF5IGNsaWNrXHJcbiAgICB0aGlzLnBvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbFwiKSkge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGhhbmRsZVN1Ym1pdChcclxuICBzdWJtaXRBY3Rpb24sXHJcbiAgcG9wdXBJbnN0YW5jZSxcclxuICBzdWJtaXRUZXh0ID0gXCJTYXZlXCIsXHJcbiAgbG9hZGluZ1RleHQgPSBcIlNhdmluZy4uLlwiXHJcbikge1xyXG4gIC8vIENoZWNrIGlmIHBvcHVwSW5zdGFuY2UgaXMgYW4gaW5zdGFuY2Ugb2YgUG9wdXBcclxuICBpZiAoIShwb3B1cEluc3RhbmNlIGluc3RhbmNlb2YgUG9wdXApKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiVGhlIHByb3ZpZGVkIHBvcHVwSW5zdGFuY2UgaXMgbm90IGFuIGluc3RhbmNlIG9mIFBvcHVwLlwiKTtcclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChcIkludmFsaWQgcG9wdXAgaW5zdGFuY2VcIik7XHJcbiAgfVxyXG5cclxuICBjb25zdCBwb3B1cCA9IHBvcHVwSW5zdGFuY2UucG9wdXBFbGVtZW50O1xyXG4gIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IHBvcHVwSW5zdGFuY2Uuc3VibWl0QnV0dG9uO1xyXG5cclxuICBpZiAoIXN1Ym1pdEJ1dHRvbikge1xyXG4gICAgY29uc29sZS5lcnJvcihcIlN1Ym1pdCBidXR0b24gbm90IGZvdW5kIGluIHBvcHVwLlwiKTtcclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChcIlN1Ym1pdCBidXR0b24gbm90IGZvdW5kXCIpO1xyXG4gIH1cclxuXHJcbiAgLy8gRW5zdXJlIHN1Ym1pdEFjdGlvbiByZXR1cm5zIGEgcHJvbWlzZVxyXG4gIHJldHVybiBQcm9taXNlLnJlc29sdmUoc3VibWl0QWN0aW9uKCkpXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIHBvcHVwSW5zdGFuY2UuY2xvc2UoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGBFcnJvcjogJHtlcnJ9YCk7XHJcbiAgICAgIC8vIEVuc3VyZSBlcnJvcnMgYXJlIHByb3BhZ2F0ZWRcclxuICAgICAgdGhyb3cgZXJyO1xyXG4gICAgfSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgcG9wdXBJbnN0YW5jZS5yZW5kZXJMb2FkaW5nKGZhbHNlLCBzdWJtaXRUZXh0KTtcclxuICAgIH0pO1xyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgZGF0YSxcclxuICAgIGNhcmRTZWxlY3RvcixcclxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXHJcbiAgICBoYW5kbGVEZWxldGVDbGljayxcclxuICAgIGhhbmRsZUxpa2VDbGlja1xyXG4gICkge1xyXG4gICAgdGhpcy5fdGl0bGUgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9pbWFnZSA9IGRhdGEubGluaztcclxuICAgIHRoaXMuX2lkID0gZGF0YS5faWQ7XHJcbiAgICB0aGlzLmlzTGlrZWQgPSBkYXRhLmlzTGlrZWQgfHwgZmFsc2U7XHJcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcclxuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrID0gaGFuZGxlRGVsZXRlQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sgPSBoYW5kbGVMaWtlQ2xpY2s7XHJcblxyXG4gICAgdGhpcy5fY2FyZFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRDYXJkRWxlbWVudCgpO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX3VwZGF0ZUxpa2VTdGF0ZSgpO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpa2UtYnV0dG9uXCIpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayh0aGlzKTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2RlbGV0ZS1idXR0b25cIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sodGhpcyk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX2NhcmRFbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19pbWFnZVwiKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHRoaXMuX3RpdGxlLCB0aGlzLl9pbWFnZSk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX2dldENhcmRFbGVtZW50KCkge1xyXG4gICAgY29uc3QgY2FyZEVsZW1lbnQgPVxyXG4gICAgICB0aGlzLl9jYXJkVGVtcGxhdGUuY29udGVudC5maXJzdEVsZW1lbnRDaGlsZC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgICBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX190aXRsZVwiKS50ZXh0Q29udGVudCA9IHRoaXMuX3RpdGxlO1xyXG4gICAgY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19faW1hZ2VcIikuc3JjID0gdGhpcy5faW1hZ2U7XHJcbiAgICBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19pbWFnZVwiKS5hbHQgPSB0aGlzLl90aXRsZTtcclxuXHJcbiAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBnZXRDYXJkRWxlbWVudCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcclxuICB9XHJcblxyXG4gIGdldElkKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2lkO1xyXG4gIH1cclxuXHJcbiAgcmVtb3ZlQ2FyZCgpIHtcclxuICAgIGlmICh0aGlzLl9jYXJkRWxlbWVudCkge1xyXG4gICAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcclxuICAgICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBudWxsO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIkNhcmQgZWxlbWVudCBpcyBudWxsIGZvciBjYXJkOlwiLCB0aGlzKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF91cGRhdGVMaWtlU3RhdGUoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlrZS1idXR0b25cIilcclxuICAgICAgLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkc19fbGlrZS1idXR0b25fYWN0aXZlXCIsIHRoaXMuaXNMaWtlZCk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVMaWtlU3RhdGUoaXNMaWtlZCkge1xyXG4gICAgdGhpcy5pc0xpa2VkID0gaXNMaWtlZDtcclxuICAgIHRoaXMuX3VwZGF0ZUxpa2VTdGF0ZSgpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlQ2FyZChkYXRhLCBoYW5kbGVJbWFnZUNsaWNrLCBoYW5kbGVEZWxldGUsIGhhbmRsZUxpa2UpIHtcclxuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXHJcbiAgICBkYXRhLFxyXG4gICAgXCIjY2FyZC10ZW1wbGF0ZVwiLFxyXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcclxuICAgIGhhbmRsZURlbGV0ZSxcclxuICAgIGhhbmRsZUxpa2VcclxuICApO1xyXG4gIHJldHVybiBjYXJkLmdldENhcmRFbGVtZW50KCk7XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbCkge1xyXG4gICAgdGhpcy5fZm9ybVNlbGVjdG9yID0gc2V0dGluZ3MuZm9ybVNlbGVjdG9yO1xyXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzLmlucHV0U2VsZWN0b3I7XHJcbiAgICB0aGlzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yID0gc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZXR0aW5ncy5lcnJvckNsYXNzO1xyXG5cclxuICAgIHRoaXMuX2Zvcm0gPSBmb3JtRWw7XHJcbiAgICB0aGlzLl9pbnB1dEVscyA9IEFycmF5LmZyb20oXHJcbiAgICAgIHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKVxyXG4gICAgKTtcclxuICAgIHRoaXMuc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKHRoaXMuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG5cclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG5cclxuICAvLyBTZXRzIHVwIGluaXRpYWwgZXZlbnQgbGlzdGVuZXJzIGZvciBmb3JtIHN1Ym1pc3Npb24gYW5kIGlucHV0IGV2ZW50c1xyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpIHtcclxuICAgIGlmICghaW5wdXRFbC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpIHtcclxuICAgIGNvbnN0IGVycm9yRWwgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XHJcbiAgICBlcnJvckVsLnRleHRDb250ZW50ID0gaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgIGlucHV0RWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpIHtcclxuICAgIGNvbnN0IGVycm9yRWwgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XHJcbiAgICBlcnJvckVsLnRleHRDb250ZW50ID0gXCJcIjtcclxuICAgIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgIHRoaXMuZGlzYWJsZUJ1dHRvbigpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5lbmFibGVCdXR0b24oKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faW5wdXRFbHMuc29tZSgoaW5wdXRFbCkgPT4gIWlucHV0RWwudmFsaWRpdHkudmFsaWQpO1xyXG4gIH1cclxuXHJcbiAgZGlzYWJsZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuc3VibWl0QnV0dG9uLnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIHRydWUpO1xyXG4gICAgdGhpcy5zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICB9XHJcblxyXG4gIGVuYWJsZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuc3VibWl0QnV0dG9uLnJlbW92ZUF0dHJpYnV0ZShcImRpc2FibGVkXCIpO1xyXG4gICAgdGhpcy5zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICB9XHJcblxyXG4gIC8vIEV2ZW50IGxpc3RlbmVycyBhcmUgZm9yIHJlYWwtdGltZSB2YWxpZGF0aW9uIGZlZWRiYWNrXHJcbiAgLy8gRnVsZmlsbHMgJ2VuYWJsZVZhbGlkYXRpb24nIHB1YmxpYyBtZXRob2QgcmVxdWlyZW1lbnRcclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5faW5wdXRFbHMuZm9yRWFjaCgoaW5wdXRFbCkgPT4ge1xyXG4gICAgICBpbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgICAvLyBUb2dnbGUgc3VibWl0IGJ1dHRvbiBzdGF0ZVxyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuXHJcbiAgICAvLyBDbGVhciBpbnB1dCBlcnJvcnNcclxuICAgIHRoaXMuX2lucHV0RWxzLmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5pbXBvcnQgeyBjcmVhdGVDYXJkIH0gZnJvbSBcIi4uL3V0aWxzL2NyZWF0ZUNhcmQuanNcIjtcclxuaW1wb3J0IHsgaGFuZGxlU3VibWl0IH0gZnJvbSBcIi4uL3V0aWxzL2hhbmRsZVN1Ym1pdC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVTdWJtaXQsIGZvcm1WYWxpZGF0b3IpIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcclxuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IGhhbmRsZVN1Ym1pdDtcclxuICAgIHRoaXMuX2Zvcm0gPSB0aGlzLnBvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiZm9ybVwiKTtcclxuICAgIHRoaXMuc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFwiYnV0dG9uW3R5cGU9J3N1Ym1pdCddXCIpO1xyXG4gICAgdGhpcy5zdWJtaXRCdXR0b25UZXh0ID0gdGhpcy5zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XHJcbiAgICB0aGlzLl9mb3JtVmFsaWRhdG9yID0gZm9ybVZhbGlkYXRvcjtcclxuICAgIHRoaXMuX2lucHV0cyA9IEFycmF5LmZyb20odGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiaW5wdXRcIikpO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMucmVuZGVyTG9hZGluZyh0cnVlKTtcclxuXHJcbiAgICAgIGNvbnN0IHN1Ym1pdFByb21pc2UgPSB0aGlzLl9oYW5kbGVTdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcblxyXG4gICAgICBpZiAoIShzdWJtaXRQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiVGhlIGhhbmRsZVN1Ym1pdCBtZXRob2QgZGlkIG5vdCByZXR1cm4gYSBwcm9taXNlLlwiKTtcclxuICAgICAgICB0aGlzLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG5cclxuICAgICAgc3VibWl0UHJvbWlzZVxyXG4gICAgICAgIC50aGVuKCgpID0+IHRoaXMuY2xvc2UoKSlcclxuICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihgRXJyb3IgZHVyaW5nIGZvcm0gc3VibWlzc2lvbjogJHtlcnJ9YCkpXHJcbiAgICAgICAgLmZpbmFsbHkoKCkgPT4gdGhpcy5yZW5kZXJMb2FkaW5nKGZhbHNlKSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHJlc2V0Rm9ybSgpIHtcclxuICAgIHRoaXMuX2Zvcm0ucmVzZXQoKTtcclxuICB9XHJcblxyXG4gIG9wZW4oZm9ybURhdGEgPSB7fSkge1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gICAgdGhpcy5fcG9wdWxhdGVGb3JtKGZvcm1EYXRhKTtcclxuICAgIHRoaXMuX2ZvY3VzRmlyc3RJbnB1dCgpO1xyXG4gICAgdGhpcy5fZm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxuICB9XHJcblxyXG4gIF9mb2N1c0ZpcnN0SW5wdXQoKSB7XHJcbiAgICBjb25zdCBmaXJzdElucHV0ID0gdGhpcy5faW5wdXRzWzBdO1xyXG4gICAgaWYgKGZpcnN0SW5wdXQpIHtcclxuICAgICAgZmlyc3RJbnB1dC5mb2N1cygpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3BvcHVsYXRlRm9ybShmb3JtRGF0YSkge1xyXG4gICAgT2JqZWN0LmVudHJpZXMoZm9ybURhdGEpLmZvckVhY2goKFtuYW1lLCB2YWx1ZV0pID0+IHtcclxuICAgICAgY29uc3QgaW5wdXQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYGlucHV0W25hbWU9XCIke25hbWV9XCJdYCk7XHJcbiAgICAgIGlmIChpbnB1dCkge1xyXG4gICAgICAgIGlucHV0LnZhbHVlID0gdmFsdWU7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcclxuXHJcbiAgICB0aGlzLl9pbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiBpbnB1dFZhbHVlcztcclxuICB9XHJcblxyXG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nLCBsb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCIpIHtcclxuICAgIGlmIChpc0xvYWRpbmcpIHtcclxuICAgICAgdGhpcy5zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5zdWJtaXRCdXR0b25UZXh0O1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iLCIvLyBKUyBpbXBvcnRzXHJcbmltcG9ydCB7IHNldHRpbmdzIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5pbXBvcnQgeyBoYW5kbGVTdWJtaXQgfSBmcm9tIFwiLi4vdXRpbHMvaGFuZGxlU3VibWl0LmpzXCI7XHJcbmltcG9ydCB7IHJlbmRlckNhcmQgfSBmcm9tIFwiLi4vdXRpbHMvcmVuZGVyQ2FyZC5qc1wiO1xyXG5pbXBvcnQgeyBjcmVhdGVDYXJkIH0gZnJvbSBcIi4uL3V0aWxzL2NyZWF0ZUNhcmQuanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBEZWxldGVDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwRGVsZXRlQ2FyZC5qc1wiO1xyXG5cclxuLy8gb3RoZXIgaW1wb3J0c1xyXG5pbXBvcnQgXCIuLi9wYWdlcy9pbmRleC5jc3NcIjtcclxuXHJcbi8vICEgRUxFTUVOVFNcclxuXHJcbi8vIFByb2ZpbGUgZWRpdFxyXG5jb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LWJ1dHRvblwiKTtcclxuY29uc3QgcHJvZmlsZVRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLXRpdGxlXCIpO1xyXG5jb25zdCBwcm9maWxlU3VidGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtc3VidGl0bGVcIik7XHJcblxyXG4vLyBDYXJkIGFkZGl0aW9uXHJcbmNvbnN0IGFkZENhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLWJ1dHRvblwiKTtcclxuXHJcbi8vIFByb2ZpbGUgaW1hZ2VcclxuY29uc3QgcHJvZmlsZUltYWdlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIi5wcm9maWxlX19hdmF0YXItZWRpdC1idXR0b25cIlxyXG4pO1xyXG5cclxuLy8gQ2FyZCBkZWxldGlvblxyXG5sZXQgY2FyZFRvRGVsZXRlID0gbnVsbDtcclxuXHJcbi8vIEZvcm0gZGF0YVxyXG5sZXQgY2FyZEZvcm1EYXRhID0ge1xyXG4gIHRpdGxlOiBcIlwiLFxyXG4gIGltYWdlOiBcIlwiLFxyXG59O1xyXG5cclxuLy8gISBGT1JNIFZBTElEQVRJT05cclxuXHJcbmNvbnN0IGZvcm1WYWxpZGF0b3JzID0ge307XHJcblxyXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKHNldHRpbmdzKSA9PiB7XHJcbiAgY29uc3QgZm9ybUxpc3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoc2V0dGluZ3MuZm9ybVNlbGVjdG9yKSk7XHJcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcclxuICAgIGNvbnN0IHZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCk7XHJcbiAgICBjb25zdCBmb3JtTmFtZSA9IGZvcm1FbGVtZW50LmdldEF0dHJpYnV0ZShcIm5hbWVcIik7XHJcbiAgICBmb3JtVmFsaWRhdG9yc1tmb3JtTmFtZV0gPSB2YWxpZGF0b3I7XHJcbiAgICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuZW5hYmxlVmFsaWRhdGlvbihzZXR0aW5ncyk7XHJcblxyXG4vLyAhIElOU1RBTlRJQVRFIENMQVNTRVNcclxuXHJcbi8vIEluc3RhbnRpYXRlIHBvcHVwc1xyXG5jb25zdCBkZWxldGVDYXJkUG9wdXAgPSBuZXcgUG9wdXBEZWxldGVDYXJkKFxyXG4gIHsgcG9wdXBTZWxlY3RvcjogXCIjY29uZmlybS1kZWxldGUtbW9kYWxcIiB9LFxyXG4gIGhhbmRsZUNvbmZpcm1EZWxldGVcclxuKTtcclxuXHJcbmNvbnN0IHByb2ZpbGVJbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgXCIjcHJvZmlsZS1pbWFnZS1tb2RhbFwiLFxyXG4gIGhhbmRsZVByb2ZpbGVJbWFnZVN1Ym1pdCxcclxuICBmb3JtVmFsaWRhdG9yc1tcInByb2ZpbGUtaW1hZ2UtZm9ybVwiXVxyXG4pO1xyXG5cclxuY29uc3QgcHJvZmlsZUVkaXRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiLFxyXG4gIGhhbmRsZVByb2ZpbGVFZGl0U3VibWl0LFxyXG4gIGZvcm1WYWxpZGF0b3JzW1wicHJvZmlsZS1lZGl0LWZvcm1cIl1cclxuKTtcclxuXHJcbmNvbnN0IGFkZENhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIFwiI2FkZC1jYXJkLW1vZGFsXCIsXHJcbiAgaGFuZGxlQWRkQ2FyZFN1Ym1pdCxcclxuICBmb3JtVmFsaWRhdG9yc1tcImFkZC1jYXJkLWZvcm1cIl1cclxuKTtcclxuXHJcbmNvbnN0IGltYWdlUHJldmlld1BvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiI2NhcmQtaW1hZ2UtbW9kYWxcIik7XHJcblxyXG4vLyBJbnN0YW50aWF0ZSBBUElcclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiMjk4ZmNhYWEtZTE3My00ZTgxLTkzMjYtZWE5NWUyMWE0NjI1XCIsXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICB9LFxyXG59KTtcclxuXHJcbi8vIEluc3RhbnRpYXRlIHVzZXIgaW5mb1xyXG5jb25zdCB1c2VyID0gbmV3IFVzZXJJbmZvKHtcclxuICB0aXRsZTogXCIucHJvZmlsZV9fdGl0bGVcIixcclxuICBzdWJ0aXRsZTogXCIucHJvZmlsZV9fc3VidGl0bGVcIixcclxuICBhdmF0YXI6IFwiLnByb2ZpbGVfX2ltYWdlXCIsXHJcbn0pO1xyXG5cclxuLy8gSW5zdGFudGlhdGUgY2FyZCBzZWN0aW9uXHJcbmV4cG9ydCBjb25zdCBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxyXG4gIHtcclxuICAgIGl0ZW1zOiBbXSxcclxuICAgIHJlbmRlcmVyOiAoaXRlbSkgPT4ge1xyXG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoXHJcbiAgICAgICAgaXRlbSxcclxuICAgICAgICBoYW5kbGVDYXJkSW1hZ2VDbGljayxcclxuICAgICAgICBoYW5kbGVEZWxldGVDbGljayxcclxuICAgICAgICBoYW5kbGVMaWtlQ2xpY2tcclxuICAgICAgKTtcclxuICAgICAgY2FyZFNlY3Rpb24uYWRkSXRlbShjYXJkRWxlbWVudCk7XHJcbiAgICB9LFxyXG4gIH0sXHJcbiAgXCIjY2FyZC1saXN0XCJcclxuKTtcclxuXHJcbi8vICEgSU5JVElBTCBEQVRBIEZFVENISU5HXHJcblxyXG4vLyBGZXRjaCBpbml0aWFsIGNhcmRzIGFuZCB1c2VyIGluZm9cclxuY29uc3QgaW5pdGlhbGl6ZSA9IGFzeW5jICgpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgW2NhcmRzLCB1c2VySW5mb10gPSBhd2FpdCBQcm9taXNlLmFsbChbXHJcbiAgICAgIGFwaS5nZXRJbml0aWFsQ2FyZHMoKSxcclxuICAgICAgYXBpLmdldFVzZXJJbmZvKCksXHJcbiAgICBdKTtcclxuXHJcbiAgICBjYXJkU2VjdGlvbi5zZXRJdGVtcyhjYXJkcyk7XHJcbiAgICB1c2VyLnNldFVzZXJJbmZvKHtcclxuICAgICAgbmFtZTogdXNlckluZm8ubmFtZSxcclxuICAgICAgYWJvdXQ6IHVzZXJJbmZvLmFib3V0LFxyXG4gICAgfSk7XHJcbiAgICB1c2VyLnNldFVzZXJBdmF0YXIoe1xyXG4gICAgICBhdmF0YXI6IHVzZXJJbmZvLmF2YXRhcixcclxuICAgIH0pO1xyXG4gIH0gY2F0Y2ggKGVycikge1xyXG4gICAgY29uc29sZS5lcnJvcihcIkluaXRpYWxpemF0aW9uIGVycm9yOlwiLCBlcnIpO1xyXG4gIH1cclxufTtcclxuXHJcbmluaXRpYWxpemUoKTtcclxuXHJcbi8vICEgRVZFTlQgSEFORExFUlNcclxuXHJcbi8vIEhhbmRsZSBwcm9maWxlIGVkaXQgZm9ybSBzdWJtaXNzaW9uXHJcbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVFZGl0U3VibWl0KHByb2ZpbGVEYXRhKSB7XHJcbiAgcmV0dXJuIGhhbmRsZVN1Ym1pdCgoKSA9PiB7XHJcbiAgICByZXR1cm4gYXBpXHJcbiAgICAgIC51cGRhdGVQcm9maWxlSW5mbyh7XHJcbiAgICAgICAgbmFtZTogcHJvZmlsZURhdGEudGl0bGUsXHJcbiAgICAgICAgZGVzY3JpcHRpb246IHByb2ZpbGVEYXRhLnN1YnRpdGxlLFxyXG4gICAgICB9KVxyXG4gICAgICAudGhlbigodXBkYXRlZERhdGEpID0+IHtcclxuICAgICAgICB1c2VyLnNldFVzZXJJbmZvKHVwZGF0ZWREYXRhKTtcclxuICAgICAgfSk7XHJcbiAgfSwgcHJvZmlsZUVkaXRQb3B1cCk7XHJcbn1cclxuXHJcbi8vIEFkZCBjYXJkIGhhbmRsZXJcclxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZFN1Ym1pdChpbnB1dFZhbHVlcykge1xyXG4gIHJldHVybiBoYW5kbGVTdWJtaXQoKCkgPT4ge1xyXG4gICAgcmV0dXJuIGFwaVxyXG4gICAgICAuYWRkQ2FyZCh7IG5hbWU6IGlucHV0VmFsdWVzLnRpdGxlLCBsaW5rOiBpbnB1dFZhbHVlcy5pbWFnZSB9KVxyXG4gICAgICAudGhlbigobmV3Q2FyZERhdGEpID0+IHtcclxuICAgICAgICBjb25zdCBuZXdDYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoXHJcbiAgICAgICAgICBuZXdDYXJkRGF0YSxcclxuICAgICAgICAgIGhhbmRsZUNhcmRJbWFnZUNsaWNrLFxyXG4gICAgICAgICAgaGFuZGxlRGVsZXRlQ2xpY2ssXHJcbiAgICAgICAgICBoYW5kbGVMaWtlQ2xpY2tcclxuICAgICAgICApO1xyXG4gICAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0obmV3Q2FyZEVsZW1lbnQpO1xyXG4gICAgICB9KTtcclxuICB9LCBhZGRDYXJkUG9wdXApO1xyXG59XHJcblxyXG4vLyBIYW5kbGUgcHJvZmlsZSBpbWFnZSBmb3JtIHN1Ym1pc3Npb25cclxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUltYWdlU3VibWl0KG5ld0ltYWdlRGF0YSkge1xyXG4gIHJldHVybiBoYW5kbGVTdWJtaXQoKCkgPT4ge1xyXG4gICAgcmV0dXJuIGFwaVxyXG4gICAgICAudXBkYXRlUHJvZmlsZUF2YXRhcih7IGF2YXRhcjogbmV3SW1hZ2VEYXRhLmltYWdlIH0pXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICB1c2VyLnNldFVzZXJBdmF0YXIoeyBhdmF0YXI6IHJlcy5hdmF0YXIgfSk7XHJcbiAgICAgIH0pO1xyXG4gIH0sIHByb2ZpbGVJbWFnZVBvcHVwKTtcclxufVxyXG5cclxuLy8gSGFuZGxlIGNhcmQgZGVsZXRlIGNvbmZpcm1hdGlvblxyXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDbGljayhjYXJkKSB7XHJcbiAgaWYgKCFjYXJkLl9jYXJkRWxlbWVudCkge1xyXG4gICAgY29uc29sZS5lcnJvcihcIkNhcmQgZWxlbWVudCBpcyBudWxsIGZvciBjYXJkOlwiLCBjYXJkKTtcclxuICB9XHJcblxyXG4gIGNhcmRUb0RlbGV0ZSA9IGNhcmQ7XHJcbiAgZGVsZXRlQ2FyZFBvcHVwLm9wZW4oKTtcclxufVxyXG5cclxuLy8gSGFuZGxlIGNhcmQgbGlrZSBidXR0b25cclxuLy8gSGFuZGxlIGNhcmQgbGlrZSBidXR0b25cclxuZnVuY3Rpb24gaGFuZGxlTGlrZUNsaWNrKGNhcmQpIHtcclxuICBjb25zdCBuZXdMaWtlU3RhdGUgPSAhY2FyZC5pc0xpa2VkO1xyXG5cclxuICAvLyBGaXJzdCB1cGRhdGUgdGhlIHN0YXRlIG9mIHRoZSBjYXJkIChmb3IgdmlzdWFsIGZlZWRiYWNrKVxyXG4gIGNhcmQudXBkYXRlTGlrZVN0YXRlKG5ld0xpa2VTdGF0ZSk7XHJcbiAgY2FyZC5pc0xpa2VkID0gbmV3TGlrZVN0YXRlO1xyXG5cclxuICAvLyBEZWZpbmUgdGhlIEFQSSByZXF1ZXN0IGJhc2VkIG9uIHRoZSBuZXcgc3RhdGVcclxuICBjb25zdCBhcGlSZXF1ZXN0ID0gbmV3TGlrZVN0YXRlXHJcbiAgICA/IGFwaS5saWtlQ2FyZChjYXJkLmdldElkKCkpXHJcbiAgICA6IGFwaS51bmxpa2VDYXJkKGNhcmQuZ2V0SWQoKSk7XHJcblxyXG4gIC8vIE1ha2UgdGhlIEFQSSByZXF1ZXN0XHJcbiAgYXBpUmVxdWVzdFxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAvLyBTdWNjZXNzOiBUaGUgc3RhdGUgd2FzIGNvcnJlY3RseSB1cGRhdGVkIG9uIHRoZSBzZXJ2ZXJcclxuICAgICAgY2FyZC51cGRhdGVMaWtlU3RhdGUobmV3TGlrZVN0YXRlKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAvLyBGYWlsdXJlOiBSZXZlcnQgdGhlIFVJIHN0YXRlIGlmIHRoZXJlIHdhcyBhbiBlcnJvclxyXG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgdG9nZ2xpbmcgbGlrZSBzdGF0ZTpcIiwgZXJyKTtcclxuICAgICAgY2FyZC51cGRhdGVMaWtlU3RhdGUoIW5ld0xpa2VTdGF0ZSk7IC8vIFJldmVydCB0aGUgdmlzdWFsIHN0YXRlXHJcbiAgICAgIGNhcmQuaXNMaWtlZCA9ICFuZXdMaWtlU3RhdGU7IC8vIFJldmVydCB0aGUgaW50ZXJuYWwgc3RhdGVcclxuICAgIH0pO1xyXG59XHJcblxyXG4vLyBIYW5kbGUgY2FyZCBkZWxldGUgY29uZmlybWF0aW9uIHN1Ym1pdFxyXG5mdW5jdGlvbiBoYW5kbGVDb25maXJtRGVsZXRlKCkge1xyXG4gIHJldHVybiBoYW5kbGVTdWJtaXQoXHJcbiAgICAoKSA9PiB7XHJcbiAgICAgIGlmICghY2FyZFRvRGVsZXRlKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIk5vIGNhcmQgdG8gZGVsZXRlLlwiKTtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiBhcGlcclxuICAgICAgICAuZGVsZXRlQ2FyZChjYXJkVG9EZWxldGUuZ2V0SWQoKSlcclxuICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAvLyBWZXJpZnkgaWYgY2FyZFRvRGVsZXRlIHN0aWxsIGhhcyBhIHZhbGlkIGVsZW1lbnRcclxuICAgICAgICAgIGlmIChjYXJkVG9EZWxldGUuX2NhcmRFbGVtZW50KSB7XHJcbiAgICAgICAgICAgIGNhcmRUb0RlbGV0ZS5yZW1vdmVDYXJkKCk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLndhcm4oXCJDYXJkIGVsZW1lbnQgaXMgbnVsbFwiKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGNhcmRUb0RlbGV0ZSA9IG51bGw7XHJcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZGVsZXRpbmcgY2FyZDpcIiwgZXJyb3IpO1xyXG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICAgIGRlbGV0ZUNhcmRQb3B1cC5jbG9zZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuICAgIGRlbGV0ZUNhcmRQb3B1cCxcclxuICAgIFwiWWVzXCIsXHJcbiAgICBcIkRlbGV0aW5nLi4uXCJcclxuICApO1xyXG59XHJcblxyXG4vLyBIYW5kbGUgY2FyZCBpbWFnZSBjbGlja1xyXG5mdW5jdGlvbiBoYW5kbGVDYXJkSW1hZ2VDbGljayhuYW1lLCBsaW5rKSB7XHJcbiAgaW1hZ2VQcmV2aWV3UG9wdXAub3BlbihuYW1lLCBsaW5rKTtcclxufVxyXG5cclxuLy8gISBFVkVOVCBMSVNURU5FUlNcclxuXHJcbi8vIFNldCBldmVudCBsaXN0ZW5lcnMgZm9yIHBvcHVwc1xyXG5wcm9maWxlRWRpdFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmFkZENhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5pbWFnZVByZXZpZXdQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5wcm9maWxlSW1hZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5kZWxldGVDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbi8vIFNldCBldmVudCBsaXN0ZW5lcnMgZm9yIGJ1dHRvbnNcclxucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjb25zdCB1c2VySW5wdXQgPSB1c2VyLmdldFVzZXJJbmZvKCk7XHJcbiAgcHJvZmlsZUVkaXRQb3B1cC5vcGVuKHtcclxuICAgIHRpdGxlOiB1c2VySW5wdXQudGl0bGUsXHJcbiAgICBzdWJ0aXRsZTogdXNlcklucHV0LnN1YnRpdGxlLFxyXG4gIH0pO1xyXG4gIGZvcm1WYWxpZGF0b3JzW1wicHJvZmlsZS1lZGl0LWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbn0pO1xyXG5cclxuYWRkQ2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGFkZENhcmRQb3B1cC5vcGVuKGNhcmRGb3JtRGF0YSk7XHJcbn0pO1xyXG5cclxucHJvZmlsZUltYWdlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgcHJvZmlsZUltYWdlUG9wdXAub3BlbigpO1xyXG59KTtcclxuIiwiLy8gZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcclxuLy8gICB7XHJcbi8vICAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxyXG4vLyAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3lvc2VtaXRlLmpwZ1wiLFxyXG4vLyAgIH0sXHJcbi8vICAge1xyXG4vLyAgICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxyXG4vLyAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xha2UtbG91aXNlLmpwZ1wiLFxyXG4vLyAgIH0sXHJcbi8vICAge1xyXG4vLyAgICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxyXG4vLyAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxyXG4vLyAgIH0sXHJcbi8vICAge1xyXG4vLyAgICAgbmFtZTogXCJMYXRlbWFyXCIsXHJcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGF0ZW1hci5qcGdcIixcclxuLy8gICB9LFxyXG4vLyAgIHtcclxuLy8gICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXHJcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvdmFub2lzZS5qcGdcIixcclxuLy8gICB9LFxyXG4vLyAgIHtcclxuLy8gICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcclxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWdvLmpwZ1wiLFxyXG4vLyAgIH0sXHJcbi8vIF07XHJcblxyXG5leHBvcnQgY29uc3Qgc2V0dGluZ3MgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc2F2ZS1idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zYXZlLWJ1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcclxufTtcclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cERlbGV0ZUNhcmQgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0sIG9uQ29uZmlybURlbGV0ZUFjdGlvbikge1xyXG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xyXG4gICAgdGhpcy5fb25Db25maXJtRGVsZXRlQWN0aW9uID0gb25Db25maXJtRGVsZXRlQWN0aW9uO1xyXG4gICAgdGhpcy5zdWJtaXRCdXR0b24gPSB0aGlzLnBvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zYXZlLWJ1dHRvblwiKTtcclxuICAgIHRoaXMuc3VibWl0QnV0dG9uVGV4dCA9IHRoaXMuc3VibWl0QnV0dG9uLnRleHRDb250ZW50O1xyXG4gIH1cclxuXHJcbiAgc2V0RGVsZXRlQ29uZmlybUNhbGxiYWNrKGNhbGxiYWNrKSB7XHJcbiAgICB0aGlzLl9vbkNvbmZpcm1EZWxldGVBY3Rpb24gPSBjYWxsYmFjaztcclxuICB9XHJcblxyXG4gIF9jb25maXJtRGVsZXRlID0gKCkgPT4ge1xyXG4gICAgaWYgKHR5cGVvZiB0aGlzLl9vbkNvbmZpcm1EZWxldGVBY3Rpb24gPT09IFwiZnVuY3Rpb25cIikge1xyXG4gICAgICAvLyBSZXR1cm4gdGhlIHByb21pc2UgZnJvbSB0aGUgY2FsbGJhY2tcclxuICAgICAgcmV0dXJuIHRoaXMuX29uQ29uZmlybURlbGV0ZUFjdGlvbigpO1xyXG4gICAgfVxyXG4gICAgLy8gUmV0dXJuIGEgcmVzb2x2ZWQgcHJvbWlzZSBpZiBubyBjYWxsYmFjayBpcyBzZXRcclxuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcclxuICB9O1xyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICBkb2N1bWVudFxyXG4gICAgICAuZ2V0RWxlbWVudEJ5SWQoXCJjb25maXJtLWRlbGV0ZS15ZXMtYnV0dG9uXCIpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGV2dCkgPT4ge1xyXG4gICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIHRoaXMucmVuZGVyTG9hZGluZyh0cnVlKTtcclxuXHJcbiAgICAgICAgY29uc3QgY29uZmlybURlbGV0ZVByb21pc2UgPSB0aGlzLl9jb25maXJtRGVsZXRlKCk7XHJcblxyXG4gICAgICAgIGlmICghKGNvbmZpcm1EZWxldGVQcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkpIHtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJUaGUgX2NvbmZpcm1EZWxldGUgbWV0aG9kIGRpZCBub3QgcmV0dXJuIGEgcHJvbWlzZS5cIik7XHJcbiAgICAgICAgICB0aGlzLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xyXG4gICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uZmlybURlbGV0ZVByb21pc2VcclxuICAgICAgICAgIC50aGVuKCgpID0+IHRoaXMuY2xvc2UoKSlcclxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKGBFcnJvciBkdXJpbmcgZGVsZXRpb246ICR7ZXJyfWApKVxyXG4gICAgICAgICAgLmZpbmFsbHkoKCkgPT4gdGhpcy5yZW5kZXJMb2FkaW5nKGZhbHNlKSk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcsIGxvYWRpbmdUZXh0ID0gXCJEZWxldGluZy4uLlwiKSB7XHJcbiAgICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICAgIHRoaXMuc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gbG9hZGluZ1RleHQ7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLnN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuc3VibWl0QnV0dG9uVGV4dDtcclxuICAgIH1cclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XHJcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQgPSB0aGlzLnBvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYXJkLWltYWdlXCIpO1xyXG4gICAgdGhpcy5fY2FwdGlvbkVsZW1lbnQgPSB0aGlzLnBvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYXB0aW9uXCIpO1xyXG5cclxuICAgIGlmICghdGhpcy5faW1hZ2VFbGVtZW50KSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJJbWFnZSBlbGVtZW50IG5vdCBmb3VuZFwiKTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIXRoaXMuX2NhcHRpb25FbGVtZW50KSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJDYXB0aW9uIGVsZW1lbnQgbm90IGZvdW5kXCIpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgb3BlbihuYW1lLCBsaW5rKSB7XHJcbiAgICBpZiAobmFtZSAmJiBsaW5rKSB7XHJcbiAgICAgIHRoaXMuX2ltYWdlRWxlbWVudC5zcmMgPSBsaW5rO1xyXG4gICAgICB0aGlzLl9pbWFnZUVsZW1lbnQuYWx0ID0gbmFtZTtcclxuICAgICAgdGhpcy5fY2FwdGlvbkVsZW1lbnQudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgICBzdXBlci5vcGVuKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiSW1hZ2UgbmFtZSBvciBsaW5rIGlzIG1pc3NpbmdcIik7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xyXG4gICAgdGhpcy5faGVhZGVycyA9IG9wdGlvbnMuaGVhZGVycztcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBvcHRpb25zLmJhc2VVcmw7XHJcbiAgfVxyXG5cclxuICAvLyBIYW5kbGUgSFRUUCByZXNwb25zZVxyXG4gIF9oYW5kbGVSZXNwb25zZShyZXMpIHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIE1ha2UgYSBmZXRjaCByZXF1ZXN0XHJcbiAgX3JlcXVlc3QodXJsLCBvcHRpb25zKSB7XHJcbiAgICByZXR1cm4gZmV0Y2godXJsLCBvcHRpb25zKS50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIC8vIENhcmRzXHJcblxyXG4gIC8vIEZldGNoIGFsbCBjYXJkc1xyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIEFkZCBhIG5ldyBjYXJkXHJcbiAgYWRkQ2FyZCh7IG5hbWUsIGxpbmsgfSkge1xyXG4gICAgaWYgKCFuYW1lIHx8ICFsaW5rKSB7XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChcIk1pc3NpbmcgbmFtZSBvciBsaW5rXCIpOyAvLyBBZGQgdGhpcyB2YWxpZGF0aW9uXHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgbGluayxcclxuICAgICAgfSksXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIERlbGV0ZSBhIGNhcmRcclxuICBkZWxldGVDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIExpa2UgYSBjYXJkXHJcbiAgbGlrZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gVW5saWtlIGEgY2FyZCAoZGlzbGlrZSlcclxuICB1bmxpa2VDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIFByb2ZpbGVcclxuXHJcbiAgLy8gVXBkYXRlIHByb2ZpbGUgaW5mb3JtYXRpb25cclxuICB1cGRhdGVQcm9maWxlSW5mbyh7IG5hbWUsIGRlc2NyaXB0aW9uIH0pIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBuYW1lLCBhYm91dDogZGVzY3JpcHRpb24gfSksXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIFVwZGF0ZSBwcm9maWxlIGF2YXRhclxyXG4gIHVwZGF0ZVByb2ZpbGVBdmF0YXIoeyBhdmF0YXIgfSkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBhdmF0YXIgfSksXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIEZldGNoIHVzZXIgaW5mb1xyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gRmV0Y2ggYm90aCB1c2VyIGluZm8gYW5kIGluaXRpYWwgY2FyZHNcclxuICBnZXRBcHBEYXRhKCkge1xyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldFVzZXJJbmZvKCksIHRoaXMuZ2V0SW5pdGlhbENhcmRzKCldKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKHsgdGl0bGUsIHN1YnRpdGxlLCBhdmF0YXIgfSkge1xyXG4gICAgdGhpcy5fdGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRpdGxlKTtcclxuICAgIHRoaXMuX3N1YnRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzdWJ0aXRsZSk7XHJcbiAgICB0aGlzLl9hdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhcik7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHRpdGxlOiB0aGlzLl90aXRsZS50ZXh0Q29udGVudC50cmltKCksXHJcbiAgICAgIHN1YnRpdGxlOiB0aGlzLl9zdWJ0aXRsZS50ZXh0Q29udGVudC50cmltKCksXHJcbiAgICAgIGF2YXRhcjogdGhpcy5fYXZhdGFyLnNyYyxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pIHtcclxuICAgIHRoaXMuX3RpdGxlLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHRoaXMuX3N1YnRpdGxlLnRleHRDb250ZW50ID0gYWJvdXQ7XHJcbiAgfVxyXG5cclxuICBzZXRVc2VyQXZhdGFyKHsgYXZhdGFyIH0pIHtcclxuICAgIHRoaXMuX2F2YXRhci5zcmMgPSBhdmF0YXI7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNsYXNzU2VsZWN0b3IpIHtcclxuICAgIC8vIEl0ZW1zIC0gYXJyYXkgb2YgZGF0YVxyXG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcclxuICAgIC8vIFJlbmRlcmVyIC0gY3JlYXRlcyBhbmQgYWRkcyBhIHNpbmdsZSBpdGVtIHRvIHBhZ2VcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICAvLyBXaGVyZSB0byBhZGQgdGhlIGVsZW1lbnRzXHJcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNsYXNzU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgLy8gTWV0aG9kIHRvIHNldCBpdGVtcyBhbmQgcmVuZGVyIHRoZW1cclxuICBzZXRJdGVtcyhpdGVtcykge1xyXG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcyB8fCBbXTtcclxuICAgIHRoaXMucmVuZGVySXRlbXMoKTtcclxuICB9XHJcblxyXG4gIC8vIENhbGwgb25jZSBvbiBwYWdlIGxvYWQgdG8gcmVuZGVyIGFsbCBpdGVtc1xyXG4gIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gQWRkIG5ldyBpdGVtcyB0byB0aGUgYmVnaW5uaW5nIG9mIHRoZSBjb250YWluZXJcclxuICBhZGRJdGVtKG5ld0l0ZW0pIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKG5ld0l0ZW0pO1xyXG4gIH1cclxuXHJcbiAgLy8gQWRkIG5ldyBpdGVtcyB0byB0aGUgZW5kIG9mIHRoZSBjb250YWluZXJcclxuICBhcHBlbmRJdGVtKG5ld0l0ZW0pIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5hcHBlbmQobmV3SXRlbSk7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJQb3B1cCIsImNvbnN0cnVjdG9yIiwiX3JlZiIsInBvcHVwU2VsZWN0b3IiLCJ0aGlzIiwiX3BvcHVwU2VsZWN0b3IiLCJwb3B1cEVsZW1lbnQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwib3BlbiIsImNsYXNzTGlzdCIsImFkZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJjbG9zZSIsInJlbW92ZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldnQiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImNvbnRhaW5zIiwiaGFuZGxlU3VibWl0Iiwic3VibWl0QWN0aW9uIiwicG9wdXBJbnN0YW5jZSIsInN1Ym1pdFRleHQiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJzdWJtaXRCdXR0b24iLCJQcm9taXNlIiwicmVzb2x2ZSIsInRoZW4iLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsImZpbmFsbHkiLCJyZW5kZXJMb2FkaW5nIiwicmVqZWN0IiwiQ2FyZCIsImRhdGEiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwiaGFuZGxlRGVsZXRlQ2xpY2siLCJoYW5kbGVMaWtlQ2xpY2siLCJfdGl0bGUiLCJuYW1lIiwiX2ltYWdlIiwibGluayIsIl9pZCIsImlzTGlrZWQiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfaGFuZGxlRGVsZXRlQ2xpY2siLCJfaGFuZGxlTGlrZUNsaWNrIiwiX2NhcmRUZW1wbGF0ZSIsIl9jYXJkRWxlbWVudCIsIl9nZXRDYXJkRWxlbWVudCIsIl9zZXRFdmVudExpc3RlbmVycyIsIl91cGRhdGVMaWtlU3RhdGUiLCJjYXJkRWxlbWVudCIsImNvbnRlbnQiLCJmaXJzdEVsZW1lbnRDaGlsZCIsImNsb25lTm9kZSIsInRleHRDb250ZW50Iiwic3JjIiwiYWx0IiwiZ2V0Q2FyZEVsZW1lbnQiLCJnZXRJZCIsInJlbW92ZUNhcmQiLCJ0b2dnbGUiLCJ1cGRhdGVMaWtlU3RhdGUiLCJjcmVhdGVDYXJkIiwiaGFuZGxlRGVsZXRlIiwiaGFuZGxlTGlrZSIsIkZvcm1WYWxpZGF0b3IiLCJzZXR0aW5ncyIsImZvcm1FbCIsIl9mb3JtU2VsZWN0b3IiLCJmb3JtU2VsZWN0b3IiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZm9ybSIsIl9pbnB1dEVscyIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJwcmV2ZW50RGVmYXVsdCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJpbnB1dEVsIiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oaWRlSW5wdXRFcnJvciIsIl9zaG93SW5wdXRFcnJvciIsImVycm9yRWwiLCJpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiX2hhc0ludmFsaWRJbnB1dCIsImRpc2FibGVCdXR0b24iLCJlbmFibGVCdXR0b24iLCJzb21lIiwic2V0QXR0cmlidXRlIiwicmVtb3ZlQXR0cmlidXRlIiwiZW5hYmxlVmFsaWRhdGlvbiIsImZvckVhY2giLCJyZXNldFZhbGlkYXRpb24iLCJpbnB1dEVsZW1lbnQiLCJQb3B1cFdpdGhGb3JtIiwiZm9ybVZhbGlkYXRvciIsInN1cGVyIiwiX2hhbmRsZVN1Ym1pdCIsInN1Ym1pdEJ1dHRvblRleHQiLCJfZm9ybVZhbGlkYXRvciIsIl9pbnB1dHMiLCJzdWJtaXRQcm9taXNlIiwiX2dldElucHV0VmFsdWVzIiwicmVzZXRGb3JtIiwicmVzZXQiLCJmb3JtRGF0YSIsIl9wb3B1bGF0ZUZvcm0iLCJfZm9jdXNGaXJzdElucHV0IiwiZmlyc3RJbnB1dCIsImZvY3VzIiwiT2JqZWN0IiwiZW50cmllcyIsInZhbHVlIiwiaW5wdXQiLCJpbnB1dFZhbHVlcyIsImlzTG9hZGluZyIsImxvYWRpbmdUZXh0IiwicHJvZmlsZUVkaXRCdXR0b24iLCJhZGRDYXJkQnV0dG9uIiwicHJvZmlsZUltYWdlQnV0dG9uIiwiY2FyZFRvRGVsZXRlIiwiY2FyZEZvcm1EYXRhIiwidGl0bGUiLCJpbWFnZSIsImZvcm1WYWxpZGF0b3JzIiwiZm9ybUVsZW1lbnQiLCJ2YWxpZGF0b3IiLCJmb3JtTmFtZSIsImdldEF0dHJpYnV0ZSIsImRlbGV0ZUNhcmRQb3B1cCIsIm9uQ29uZmlybURlbGV0ZUFjdGlvbiIsIl9vbkNvbmZpcm1EZWxldGVBY3Rpb24iLCJzZXREZWxldGVDb25maXJtQ2FsbGJhY2siLCJjYWxsYmFjayIsIl9jb25maXJtRGVsZXRlIiwiZ2V0RWxlbWVudEJ5SWQiLCJjb25maXJtRGVsZXRlUHJvbWlzZSIsImFwaSIsImRlbGV0ZUNhcmQiLCJ3YXJuIiwicHJvZmlsZUltYWdlUG9wdXAiLCJuZXdJbWFnZURhdGEiLCJ1cGRhdGVQcm9maWxlQXZhdGFyIiwiYXZhdGFyIiwicmVzIiwidXNlciIsInNldFVzZXJBdmF0YXIiLCJwcm9maWxlRWRpdFBvcHVwIiwicHJvZmlsZURhdGEiLCJ1cGRhdGVQcm9maWxlSW5mbyIsImRlc2NyaXB0aW9uIiwic3VidGl0bGUiLCJ1cGRhdGVkRGF0YSIsInNldFVzZXJJbmZvIiwiYWRkQ2FyZFBvcHVwIiwiYWRkQ2FyZCIsIm5ld0NhcmREYXRhIiwibmV3Q2FyZEVsZW1lbnQiLCJoYW5kbGVDYXJkSW1hZ2VDbGljayIsImNhcmRTZWN0aW9uIiwiYWRkSXRlbSIsImltYWdlUHJldmlld1BvcHVwIiwiX2ltYWdlRWxlbWVudCIsIl9jYXB0aW9uRWxlbWVudCIsIm9wdGlvbnMiLCJfaGVhZGVycyIsImhlYWRlcnMiLCJfYmFzZVVybCIsImJhc2VVcmwiLCJfaGFuZGxlUmVzcG9uc2UiLCJvayIsImpzb24iLCJzdGF0dXMiLCJfcmVxdWVzdCIsInVybCIsImZldGNoIiwiZ2V0SW5pdGlhbENhcmRzIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJjYXJkSWQiLCJsaWtlQ2FyZCIsInVubGlrZUNhcmQiLCJfcmVmMiIsImFib3V0IiwiX3JlZjMiLCJnZXRVc2VySW5mbyIsImdldEFwcERhdGEiLCJhbGwiLCJhdXRob3JpemF0aW9uIiwiX3N1YnRpdGxlIiwiX2F2YXRhciIsInRyaW0iLCJjbGFzc1NlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJzZXRJdGVtcyIsInJlbmRlckl0ZW1zIiwiaXRlbSIsIm5ld0l0ZW0iLCJwcmVwZW5kIiwiYXBwZW5kSXRlbSIsImFwcGVuZCIsImNhcmQiLCJuZXdMaWtlU3RhdGUiLCJhc3luYyIsImNhcmRzIiwidXNlckluZm8iLCJpbml0aWFsaXplIiwidXNlcklucHV0Il0sInNvdXJjZVJvb3QiOiIifQ==